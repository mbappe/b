#!/bin/bash

function report {
    echo
    echo Successes: $SUCCESSES
    echo Failures: $FAILURES
    echo
}

trap "echo; report; exit 2" SIGHUP SIGINT SIGTERM

if [ -x Judy1LHCheck ]
then
    CHECK=Judy1LHCheck
else
    CHECK=check
fi

let SUCCESSES=0
let FAILURES=0

for B in {10..64}
do
    for d_ARG in '' -d
    do
    for D_ARG in '' -D
    do
    for S_ARG in '' -S1
    do
        CMD="$CHECK -B$B $S_ARG $D_ARG $d_ARG"
        echo $CMD
        if $CMD > /dev/null
        then
            let SUCCESSES=$SUCCESSES+1
        else
            let FAILURES=$FAILURES+1
        fi
    done
    done
    done
done

report

if [ $FAILURES -ne 0 ]
then
    exit 1
fi
