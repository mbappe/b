#!/bin/sh -x

# What is the goal of this regression test script?
# How much memory should it require? Should it test and adapt?

# Use a -DDEBUG build.

TIME=Judy1LHTime
CHECK=Judy1LHCheck

# Basic runs we use for performance testing:
# ${TIME} -1m
# ${TIME} -1m -E
# ${TIME} -1m -DS1
# ${TIME} -Lm
# ${TIME} -Lm -E
# ${TIME} -Lm -DS1

: \
&& ${TIME} -W0 -B16 -1lvdgi  -n4 -S1 -s0xfffd \
&& ${TIME} -W0 -B64 -1lvdgi  -n4 -S1 -s0xfffffffffffffffd \
&& ${TIME} -W0 -B16 -1lvdgi  -n4 -S-1 -s2 \
&& ${TIME} -W0 -B16 -1lvdgi  -n4 -S-1 -s2 --splay-key-bits=0xffff000000000000 \
&& :
if [ $? != 0 ]
then
    exit 1
fi

: \
&& ${TIME} -W0 -B16 -Llvdgi  -n4 -S1 -s0xfffd \
&& ${TIME} -W0 -B64 -Llvdgi  -n4 -S1 -s0xfffffffffffffffd \
&& ${TIME} -W0 -B16 -Llvdgi  -n4 -S-1 -s2 \
&& ${TIME} -W0 -B16 -Llvdgi  -n4 -S-1 -s2 --splay-key-bits=0xffff000000000000 \
&& :
if [ $? != 0 ]
then
    exit 1
fi

: \
&& ${TIME} -W0 -B25 -1lCvdgi -n1e5      --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -1lvdgi  -n1e5 -S1  --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -1lvdgi  -n1e5 -DS1 --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -1lvdgi  -n1e5 \
&& ${TIME} -W0 -B25 -1lCvdgi -n1e5 -S1 \
&& ${TIME} -W0 -B25 -1lvdgi  -n1e5 -DS1 \
&& ${TIME} -W0 -B32 -1lh     -n1e5 -S1  --splay-key-bits=0xff00aa00aa00ffff \
&& :
if [ $? != 0 ]
then
    exit 1
fi

: \
&& ${TIME} -W0 -B25 -LlCvdgi -n1e5      --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -Llvdgi  -n1e5 -S1  --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -Llvdgi  -n1e5 -DS1 --splay-key-bits=0x0400aa00aa00ffff \
&& ${TIME} -W0 -B25 -Llvdgi  -n1e5 \
&& ${TIME} -W0 -B25 -Llvdgi  -n1e5 -S1 \
&& ${TIME} -W0 -B25 -LlCvdgi -n1e5 -DS1 \
&& ${TIME} -W0 -B32 -Llh     -n1e5 -S1  --splay-key-bits=0xff00aa00aa00ffff \
&& ${TIME} -W0 -B33 -Rlvdgi  -n1e5 \
&& :
if [ $? != 0 ]
then
    exit 1
fi

:\
&& ${CHECK} -B17 -C \
&& ${CHECK} -B17 -C -S1 \
&& ${CHECK} -B17 -C -DS1 \
&& ${CHECK} -B25 \
&& ${CHECK} -B25 -S1 \
&& ${CHECK} -B25 -DS1 \
&& ${CHECK} -B33 -C \
&& ${CHECK} -B33 -C -S1 \
&& ${CHECK} -B33 -C -DS1 \
&& :
if [ $? != 0 ]
then
    exit 1
fi

#&& bcheckall 64 \

exit 0
